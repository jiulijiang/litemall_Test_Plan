# 性能测试监控指标

## 1. 应用层监控指标

### 1.1 响应时间相关指标
- **平均响应时间(Average Response Time)**
  - 定义：所有请求响应时间的平均值
  - 监控工具：JMeter聚合报告
  - 预期标准：根据业务要求设定（如<2000ms）

- **90%响应时间(90th Percentile)**
  - 定义：90%的请求响应时间不超过该值
  - 监控工具：JMeter聚合报告
  - 预期标准：根据业务要求设定（如<2500ms）

- **95%响应时间(95th Percentile)**
  - 定义：95%的请求响应时间不超过该值
  - 监控工具：JMeter聚合报告
  - 预期标准：根据业务要求设定

- **99%响应时间(99th Percentile)**
  - 定义：99%的请求响应时间不超过该值
  - 监控工具：JMeter聚合报告
  - 预期标准：根据业务要求设定

- **最小响应时间(Min Response Time)**
  - 定义：所有请求中响应时间最短的值
  - 监控工具：JMeter聚合报告

- **最大响应时间(Max Response Time)**
  - 定义：所有请求中响应时间最长的值
  - 监控工具：JMeter聚合报告

### 1.2 吞吐量相关指标
- **每秒事务数(TPS - Transactions Per Second)**
  - 定义：系统每秒成功处理的事务数量
  - 监控工具：JMeter聚合报告
  - 预期标准：根据业务高峰期需求设定

- **每秒请求数(Hits Per Second)**
  - 定义：系统每秒接收的请求数量
  - 监控工具：JMeter聚合报告

- **每秒字节数(Bytes Per Second)**
  - 定义：系统每秒传输的数据量
  - 监控工具：JMeter聚合报告

### 1.3 错误率相关指标
- **错误率(Error Rate)**
  - 定义：失败请求数占总请求数的比例
  - 计算公式：错误率 = (失败请求数 / 总请求数) × 100%
  - 监控工具：JMeter聚合报告
  - 预期标准：< 0.1%

- **HTTP错误状态码统计**
  - 定义：各类HTTP错误状态码出现的次数和比例
  - 监控工具：JMeter断言结果、查看结果树

### 1.4 并发相关指标
- **并发用户数(Concurrent Users)**
  - 定义：同时向系统发送请求的虚拟用户数
  - 监控工具：JMeter线程组设置

- **活跃线程数(Active Threads)**
  - 定义：当前正在执行请求的线程数
  - 监控工具：JMeter聚合报告

## 2. 系统资源监控指标

### 2.1 CPU使用率
- **CPU总体使用率**
  - 定义：CPU被使用的百分比
  - 监控工具：Windows性能监视器、Linux top命令、JMeter插件
  - 预期标准：< 80%

- **CPU各核心使用率**
  - 定义：多核CPU中每个核心的使用率
  - 监控工具：Windows性能监视器、Linux top命令

### 2.2 内存使用情况
- **内存使用率**
  - 定义：已使用内存占总内存的百分比
  - 监控工具：Windows性能监视器、Linux free命令、JMeter插件
  - 预期标准：< 80%

- **堆内存使用情况(JVM)**
  - 定义：Java应用堆内存的使用情况
  - 监控工具：JConsole、JVisualVM、JMeter插件

- **非堆内存使用情况(JVM)**
  - 定义：Java应用非堆内存的使用情况
  - 监控工具：JConsole、JVisualVM、JMeter插件

### 2.3 磁盘I/O指标
- **磁盘读写速度**
  - 定义：磁盘每秒读写字节数
  - 监控工具：Windows性能监视器、Linux iostat命令

- **磁盘使用率**
  - 定义：磁盘已使用空间占总空间的百分比
  - 监控工具：Windows资源监视器、Linux df命令

- **磁盘队列长度**
  - 定义：等待磁盘I/O操作的请求数
  - 监控工具：Windows性能监视器、Linux iostat命令

### 2.4 网络指标
- **网络带宽使用率**
  - 定义：网络接口的带宽使用百分比
  - 监控工具：Windows性能监视器、Linux ifstat命令

- **网络吞吐量**
  - 定义：网络接口每秒接收和发送的字节数
  - 监控工具：Windows性能监视器、Linux ifstat命令

- **网络连接数**
  - 定义：当前建立的网络连接数量
  - 监控工具：Windows netstat命令、Linux netstat命令

## 3. 数据库监控指标

### 3.1 数据库连接指标
- **活动连接数**
  - 定义：当前正在使用的数据库连接数
  - 监控工具：数据库监控工具、应用日志

- **连接池使用率**
  - 定义：已使用连接数占连接池最大连接数的比例
  - 监控工具：应用监控、数据库监控工具

### 3.2 数据库性能指标
- **SQL执行时间**
  - 定义：SQL语句的执行时间
  - 监控工具：数据库慢查询日志、APM工具

- **查询吞吐量**
  - 定义：数据库每秒处理的查询数量
  - 监控工具：数据库监控工具

- **缓存命中率**
  - 定义：数据库缓存命中的比例
  - 监控工具：数据库监控工具

## 4. 应用服务器监控指标

### 4.1 Tomcat/Jetty等Web服务器指标
- **线程池使用情况**
  - 定义：Web服务器线程池中活跃线程和空闲线程的数量
  - 监控工具：JMX监控、APM工具

- **请求处理时间**
  - 定义：Web服务器处理请求的时间
  - 监控工具：访问日志分析、APM工具

### 4.2 应用性能监控(APM)指标
- **方法执行时间**
  - 定义：应用中关键方法的执行时间
  - 监控工具：APM工具（如SkyWalking、Pinpoint）

- **服务调用链路**
  - 定义：分布式系统中服务间的调用关系和耗时
  - 监控工具：APM工具

## 5. 监控工具和方法

### 5.1 JMeter内置监控
- 聚合报告(Aggregate Report)
- 查看结果树(View Results Tree)
- 图形结果(Graph Results)
- 断言结果(Assertion Results)

### 5.2 系统级监控工具
- Windows性能监视器(Performance Monitor)
- Linux top、iostat、vmstat、netstat等命令
- 第三方监控工具(如Zabbix、Prometheus)

### 5.3 应用级监控工具
- JConsole、JVisualVM
- APM工具(SkyWalking、Pinpoint等)
- 日志分析工具

## 6. 监控频率和采样策略

### 6.1 实时监控
- 在测试执行过程中持续监控关键指标
- 采样频率：每秒采集一次

### 6.2 定期采样
- 对于系统资源等指标，可适当降低采样频率
- 采样频率：每5-10秒采集一次

### 6.3 关键节点采样
- 在负载变化点、测试场景切换点进行重点采样
- 采样时机：负载增加前、稳定运行期、负载减少后

## 7. 监控告警阈值

### 7.1 性能指标告警阈值
- 响应时间超过预期标准的120%
- TPS低于预期标准的80%
- 错误率超过0.1%

### 7.2 系统资源告警阈值
- CPU使用率超过85%
- 内存使用率超过85%
- 磁盘使用率超过90%

### 7.3 数据库告警阈值
- 数据库连接池使用率超过90%
- SQL执行时间超过预期标准的150%